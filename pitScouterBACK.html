<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pit Scouting Viewer</title>
    <link href="bootstrap.min.css" rel="stylesheet">
    <script src="jquery-3.3.1.slim.min.js"></script>
    <script src="showdown.min.js"></script>
    <style>
        /* General Styles */
        body,
nav,
header,
.navbar,
#footer,
a,
#backgroundImage {
    transition: background-color 0.3s ease, color 0.3s ease;
}

body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f4;
    display: block;
}

#container {
    max-width: 800px;
    margin: 20px auto;
    background: white;
    padding: 20px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

h1 {
    text-align: center;
    margin-bottom: 20px;
}

#upload-section {
    text-align: center;
    margin-bottom: 20px;
}

#fileList ul {
    list-style-type: none;
    padding: 0;
}

#fileList li {
    padding: 10px;
    border-bottom: 1px solid #ddd;
    cursor: pointer;
}

#fileList li:hover {
    background-color: #f0f0f0;
}

#backBtn {
    margin-bottom: 10px;
}

#jsonViewer {
    white-space: pre-wrap;
    word-wrap: break-word;
    background-color: #f9f9f9;
    padding: 15px;
    border: 1px solid #ddd;
    border-radius: 4px;
}

.bg-dark,
.navbar-dark,
.card {
    background-color: #343a40 !important;
    color: #f8f9fa !important;
}

.bg-light,
.navbar-light,
.card {
    background-color: #f8f9fa !important;
    color: #343a40 !important;
}

.navbar-dark .navbar-nav .nav-link,
.navbar-dark .navbar-brand {
    color: #f8f9fa !important;
}

.navbar-dark .navbar-toggler-icon {
    background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'%3e%3cpath stroke='rgba(248, 249, 250, 1)' stroke-width='2' stroke-linecap='round' stroke-miterlimit='10' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e") !important;
}

.switch {
    position: relative;
    display: inline-block;
    width: 80px;
    height: 34px;
    margin: 10px;
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: background-color .4s;
    border-radius: 34px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: transform .4s;
    border-radius: 50%;
}

input:checked+.slider {
    background-color: #555;
}

input:checked+.slider:before {
    transform: translateX(46px);
}

.icon {
    color: #fff;
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    font-size: 20px;
    transition: opacity 0.4s;
}

.sun {
    left: 10px;
    opacity: 0;
}

.moon {
    right: 10px;
    opacity: 1;
}

input:checked+.slider .sun {
    opacity: 1;
}

input:checked+.slider .moon {
    opacity: 0;
}

input:not(:checked)+.slider .sun {
    opacity: 0;
}

input:not(:checked)+.slider .moon {
    opacity: 1;
}

/* Dark mode styles for container */
.dark-mode #container {
    background-color: #454d55;
    color: #f8f9fa;
}

.dark-mode #jsonViewer {
    background-color: #3a3f44;
    border-color: #555;
    color: #f8f9fa;
}

.dark-mode #fileList li:hover {
    background-color: #555;
    color: #f8f9fa; /* Ensure text color changes on hover */
}


    </style>
</head>

<body>

    <nav class="navbar navbar-expand-lg shadow-sm mb-5">
        <div class="container">
            <a class="navbar-brand" href="#" id="roborte">Robort</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="./index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./Team_List_element.html">Teams</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Scouting
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="./Strat_Board_w_tabs.html">Canvas</a>
                            <a class="dropdown-item" href="./scoutingGen.html">Scouting Generator</a>
                            <a class="dropdown-item" href="./scoutingUI.html">Live Scouter (WIP)</a>
                            <a class="dropdown-item" href="./pitScouterFRONT.html">Pit Scouter</a>
                            <a class="dropdown-item" href="./pitScouterBACK.html">Pit Scouter BACK</a>
    
                            
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./Checklist.html">Pre Match Checklist</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./2423_Features.html">Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Config_tab.html">Configure</a>
                    </li>
                </ul>
                <label class="switch">
                    <input type="checkbox" id="darkModeToggle">
                    <span class="slider round">
                        <span class="icon sun">ðŸŒž</span> <!-- Sun icon -->
                        <span class="icon moon">ðŸŒœ</span> <!-- Moon icon -->
                    </span>
                </label>
            </div>
        </div>
    </nav>

    <div id="container">
        <h1 id="h1">Pit Scouting Viewer</h1>
        <div id="upload-section">
            <input type="file" id="fileInput" webkitdirectory directory multiple>
            <button id="uploadBtn" class="btn btn-primary mt-3">Upload Folder</button>
        </div>
        <div id="fileList"></div>
        <div id="fileContent" style="display:none;">
            <button id="backBtn" class="btn btn-secondary">Back to List</button>
            <pre id="jsonViewer"></pre>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let jsonFiles = {}; // Store JSON files in memory

            document.getElementById('uploadBtn').addEventListener('click', () => {
                const input = document.getElementById('fileInput');
                const files = input.files;

                if (files.length === 0) {
                    alert('Please upload a folder containing JSON files.');
                    return;
                }

                jsonFiles = {}; // Reset the storage

                // Create an array of promises for reading all files
                const fileReadPromises = Array.from(files).map(file => {
                    return new Promise((resolve, reject) => {
                        if (file.type === 'application/json') {
                            const reader = new FileReader();
                            reader.onload = (event) => {
                                jsonFiles[file.name] = event.target.result;
                                resolve();
                            };
                            reader.onerror = reject;
                            reader.readAsText(file);
                        } else {
                            resolve(); // Ignore non-JSON files
                        }
                    });
                });

                // Wait for all files to be read
                Promise.all(fileReadPromises)
                    .then(() => {
                        displayFileList();
                    })
                    .catch(error => {
                        console.error("Error reading files:", error);
                    });
            });

            document.getElementById('backBtn').addEventListener('click', () => {
                document.getElementById('fileContent').style.display = 'none';
                document.getElementById('fileList').style.display = 'block';
            });

            function displayFileList() {
                const fileList = document.getElementById('fileList');
                fileList.innerHTML = '<ul></ul>';
                const ul = fileList.querySelector('ul');

                console.log(jsonFiles);

                // Convert jsonFiles to an array of objects with filename and content
                const filesArray = Object.entries(jsonFiles).map(([filename, content]) => {
                    return { filename, content };
                });

                console.log(filesArray); // Should now contain all the file data

                // Iterate over the array and display only the first 4 characters of each filename
                filesArray.forEach(file => {
                    const shortName = file.filename.substring(0, 4); // Get the first 4 characters
                    console.log(shortName);
                    const li = document.createElement('li');
                    li.textContent = shortName;
                    li.addEventListener('click', () => viewFileContent(file.filename)); // Use the full filename to view content
                    ul.appendChild(li);
                });
            }

            function viewFileContent(filename) {
                const content = jsonFiles[filename];
                const jsonObject = JSON.parse(content); // Parse the JSON string into an object

                const jsonViewer = document.getElementById('jsonViewer');
                jsonViewer.innerHTML = ''; // Clear previous content

                // Create a formatted display of key-value pairs
                Object.entries(jsonObject).forEach(([key, value]) => {
                    const line = document.createElement('div');
                    line.classList.add('json-line');

                    const keySpan = document.createElement('span');
                    keySpan.classList.add('json-key');
                    keySpan.textContent = key + ': ';

                    const valueSpan = document.createElement('span');
                    valueSpan.classList.add('json-value');
                    valueSpan.textContent = value;

                    line.appendChild(keySpan);
                    line.appendChild(valueSpan);
                    jsonViewer.appendChild(line);
                });

                document.getElementById('fileList').style.display = 'none';
                document.getElementById('fileContent').style.display = 'block';
            }
        });

        // Dark Mode Toggle Script
        document.addEventListener('DOMContentLoaded', function() {
    const toggle = document.getElementById('darkModeToggle');
    const body = document.body;
    const navbar = document.querySelector('.navbar');

    // Function to apply dark mode classes
    function enableDarkMode() {
        body.classList.add('bg-dark', 'dark-mode');
        body.classList.remove('bg-light');
        navbar.classList.add('navbar-dark');
        navbar.classList.remove('navbar-light', 'bg-white');
        document.querySelectorAll('.navbar').forEach(element => {
            element.classList.add('bg-dark');
            element.classList.remove('bg-white');
        });
    }

    // Function to remove dark mode classes
    function disableDarkMode() {
        body.classList.add('bg-light');
        body.classList.remove('bg-dark', 'dark-mode');
        navbar.classList.add('navbar-light');
        navbar.classList.remove('navbar-dark', 'bg-dark');
        document.querySelectorAll('.navbar').forEach(element => {
            if (!element.closest('#aboutModal')) {
                element.classList.add('bg-white');
                element.classList.remove('bg-dark');
            }
        });
    }

    // Initialize dark mode from local storage
    if (localStorage.getItem('darkMode') === 'true') {
        enableDarkMode();
        toggle.checked = true;
    } else {
        disableDarkMode();
    }

    // Toggle dark mode on change
    toggle.addEventListener('change', function() {
        if (this.checked) {
            localStorage.setItem('darkMode', 'true');
            enableDarkMode();
        } else {
            localStorage.setItem('darkMode', 'false');
            disableDarkMode();
        }
    });
});
    </script>
</body>

</html>
