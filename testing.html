<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FRC Scouting App - Autonomous Mode</title>
    <style>
        /* Container for the canvas and markers */
        #fieldContainer {
            position: relative;
            width: 1155px;
            height: 601px;
            margin: 0 auto;
        }

        /* Styles for the canvas */
        #field-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 1155px;
            height: 601px;
            background-image: url('images/crescendo_feild.png'); /* Set your field image here */
            background-size: cover;
            background-repeat: no-repeat;
            z-index: 0; /* Behind the markers */
        }

        /* Styles for the markers */
        #defenseMarkerRED,
        #defenseMarkerGREEN,
        #defenseMarkerPURPLE {
            position: absolute;
            z-index: 1; /* Above the canvas */
            cursor: move;
        }

        /* Existing styles */
        #field {
            width: 100%;
            background-size: contain;
            width: 1152px;
            height: 664px;
            position: fixed;
            right: 20px;
        }

        #position-btn-p1,
        #position-btn-p2,
        #position-btn-p3,
        #position-btn-p4,
        #driver-station-btn-1,
        #driver-station-btn-2,
        #driver-station-btn-3 {
            position: absolute;
            background-color: rgba(0, 123, 255, 0.5);
            border: none;
            color: white;
            padding: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #position-btn-p5,
        #position-btn-p6,
        #position-btn-p7,
        #position-btn-p8,
        #driver-station-btn-4,
        #driver-station-btn-5,
        #driver-station-btn-6 {
            position: absolute;
            background-color: rgba(255, 65, 65, 0.6);
            border: none;
            color: white;
            padding: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .position-btn:hover,
        .driver-station-btn:hover {
            background-color: rgba(0, 123, 255, 0.8);
        }

        .driver-station-btn {
            left: 1%;
        }

        #info {
            margin-top: 20px;
            padding-bottom: 20px;
            text-align: center;
        }

        .position-btn.red,
        .driver-station-btn.red {
            background-color: rgba(255, 0, 0, 0.5);
        }

        .position-btn.red:hover,
        .driver-station-btn.red:hover {
            background-color: rgba(255, 0, 0, 0.8);
        }

        #notesContainer .note-btn {
            background-color: rgba(0, 200, 150, 0.5);
            border: none;
            color: white;
            padding: 8px 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #notesContainer .note-btn:hover {
            background-color: rgba(0, 200, 150, 0.8);
        }

        #noteOutcome button {
            margin: 0 5px;
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }

        #noteOutcome button:hover {
            background-color: #45a049;
        }

        #teleopContainer button {
            margin: 10px;
            padding: 8px 20px;
            color: white;
            border: none;
            cursor: pointer;
        }

        #teleopContainer {
            position: relative;
            width: 1152px;
            height: 664px;
            background-size: contain;
        }

        #miss {
            top: 100px;
            left: 300px;
            width: 100px;
            height: 50px;
            background-color: #45a049;
        }

        #groundPickupButton1 {
            top: 50px;
            left: 230px;
            font-size: 20px;
            background-color: green;
            position: absolute;
            width: 200px;
            height: 120px;
            opacity: 60%;
        }

        #groundPickupButton2 {
            top: 195px;
            left: 230px;
            font-size: 20px;
            background-color: green;
            position: absolute;
            width: 200px;
            height: 120px;
            opacity: 60%;
        }

        #groundPickupButton3 {
            top: 340px;
            left: 230px;
            font-size: 20px;
            background-color: green;
            position: absolute;
            width: 200px;
            height: 120px;
            opacity: 60%;
        }

        #sourceButton {
            top: 50px;
            left: 10px;
            width: 200px;
            height: 195px;
            font-size: 30px;
            background-color: blue;
            position: absolute;
            opacity: 60%;
        }

        #sourceButton2 {
            top: 265px;
            left: 10px;
            width: 200px;
            height: 195px;
            font-size: 30px;
            background-color: red;
            position: absolute;
            opacity: 60%;
        }

        #speaker {
            font-size: 30px;
            position: absolute;
            top: 50px;
            left: 20px;
            width: 200px;
            height: 150px;
            background-color: blue;
            opacity: 60%;
        }

        #amp {
            font-size: 30px;
            position: absolute;
            top: 210px;
            left: 100px;
            width: 200px;
            height: 150px;
            background-color: blue;
            opacity: 60%;
        }

        #pass {
            font-size: 30px;
            position: absolute;
            top: 370px;
            left: 20px;
            width: 200px;
            height: 150px;
            background-color: blue;
            opacity: 60%;
        }

        #StageRightBLUE {
            background-color: blue;
            top: 470px;
            left: 20px;
            width: 200px;
            height: 200px;
            font-size: 20px;
            position: absolute;
            opacity: 60%;
        }

        #StageLeftBLUE {
            background-color: blue;
            top: 260px;
            left: 20px;
            width: 200px;
            height: 200px;
            font-size: 20px;
            position: absolute;
            opacity: 60%;
        }

        #CenterStageBLUE {
            background-color: blue;
            top: 365px;
            left: 230px;
            width: 200px;
            height: 200px;
            font-size: 20px;
            position: absolute;
            opacity: 60%;
        }

        #None {
            top: 600px;
            left: 300px;
            width: 100px;
            height: 50px;
            font-size: 20px;
            background-color: green;
            position: absolute;
            opacity: 60%;
        }

        #StageRightRED {
            background-color: red;
            top: 150px;
            left: 230px;
            width: 200px;
            height: 200px;
            font-size: 20px;
            position: absolute;
            opacity: 60%;
        }

        #StageLeftRED {
            background-color: red;
            top: -60px;
            left: 230px;
            width: 200px;
            height: 200px;
            font-size: 20px;
            position: absolute;
            opacity: 60%;
        }

        #CenterStageRED {
            background-color: red;
            top: 50px;
            left: 20px;
            width: 200px;
            height: 200px;
            font-size: 20px;
            position: absolute;
            opacity: 60%;
        }

        .button-link {
            display: inline-block;
            padding: 10px 20px;
            font-size: 1.5rem;
            color: white;
            background-color: #007bff;
            text-align: center;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.2s ease;
        }

        .button-link:hover {
            background-color: #0056b3;
        }

        #notesSection {
            position: relative;
            width: 400px;
            padding: 10px;
            box-sizing: border-box;
            background: #f8f9fa;
            border-top: 1px solid #ccc;
            top: 645px;
            left: 1000px;
        }

        #notes {
            position: relative;
            width: 100%;
            height: 80px;
            padding: 5px;
            box-sizing: border-box;
        }

        .large-button {
            font-size: 1.5rem;
            padding: 10px 20px;
            border-radius: 0.5rem;
            margin: 5px;
            transition: background-color 0.1s ease, transform 0.3s ease;
        }

        .large-button:hover {
            background-color: #007bff;
            color: #fff;
        }

        .large-input {
            font-size: 1.5rem;
            padding: 10px;
            border-radius: 0.5rem;
            margin: 5px;
            width: 10%;
            box-sizing: border-box;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .large-input:focus {
            border-color: #007bff;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
        }

        #endgameStart {
            background-color: #007bff;
        }

        #teleopStart {
            background-color: rgb(6, 206, 6);
        }

        #reload {
            background-color: rgb(252, 39, 11);
        }

        #start {
            background-color: rgb(217, 255, 0);
        }
    </style>
</head>
<body>
    <div id="info">
        <a class="button-link" href="./index.html">Robort Home</a>
        <input type="number" id="matchNumber" class="large-input" placeholder="Match Number">
        <input type="number" id="teamNumber" class="large-input" placeholder="Team Number">
        <button id="start" class="large-button" onclick="startScouting()">Start Scouting</button>
        <button id="teleopStart" class="large-button" onclick="startTeleop()">Start Teleop</button>
        <button id="endgameStart" class="large-button" onclick="startEndgame()">Start Endgame</button>
        <button style="background-color: orange;" class="large-button" onclick="downloadSessionStorageData()">Download Data</button>
        <button style="background-color: aqua;" class="large-button" onclick="rotateField()">Rotate Field</button>
        <button id="reload" class="large-button" onclick="location.reload()">Reload Scouter</button>
    </div>

    <!-- Field Container with Canvas and Markers -->
    <div id="fieldContainer">
        <canvas id="field-canvas" width="1155" height="601"></canvas>

        <!-- Markers positioned over the canvas -->
        <img src="images/redMarker.png" id="defenseMarkerRED" draggable="true" ondragstart="drag(event)" width="50" height="50" style="left: 50px; top: 0px;">
        <img src="images/greenMarker.png" id="defenseMarkerGREEN" draggable="true" ondragstart="drag(event)" width="50" height="50" style="left: 110px; top: 0px;">
        <img src="images/purpleMarker.png" id="defenseMarkerPURPLE" draggable="true" ondragstart="drag(event)" width="50" height="50" style="left: 170px; top: 0px;">
    </div>

    <!-- Rest of your content -->
    <div id="field">
        <button id="driver-station-btn-1" class="driver-station-btn" style="top: 20%; width:120px;">Driver Station 1
            BLUE</button>
        <button id="driver-station-btn-2" class="driver-station-btn" style="top: 45%; width:120px;">Driver Station 2
            BLUE</button>
        <button id="driver-station-btn-3" class="driver-station-btn" style="top: 60%; width: 120px;">Driver Station 3
            BLUE</button>

        <button id="driver-station-btn-6" class="driver-station-btn" style="top: 20%; left: 90%;">Driver Station 3
            RED</button>
        <button id="driver-station-btn-5" class="driver-station-btn" style="top: 45%; left: 90%;">Driver Station 2
            RED</button>
        <button id="driver-station-btn-4" class="driver-station-btn" style="top: 60%; left: 90%;">Driver Station 1
            RED</button>

        <button id="position-btn-p1" class="position-btn" style="top: 22%; left: 15%;">Position 1</button>
        <button id="position-btn-p2" class="position-btn" style="top: 34%; left: 18%;">Position 2</button>
        <button id="position-btn-p3" class="position-btn" style="top: 46%; left: 15%;">Position 3</button>
        <button id="position-btn-p4" class="position-btn" style="top: 60%; left: 15%;">Position 4</button>

        <button id="position-btn-p5" class="position-btn" style="top: 22%; left: 78%;">Position 5</button>
        <button id="position-btn-p6" class="position-btn" style="top: 34%; left: 75%;">Position 6</button>
        <button id="position-btn-p7" class="position-btn" style="top: 46%; left: 78%;">Position 7</button>
        <button id="position-btn-p8" class="position-btn" style="top: 60%; left: 78%;">Position 8</button>
        <!-- Notes Container -->
        <div id="notesContainer" style="display: none; position: relative; width: 100%; height: 100%;">
            <!-- Note Buttons -->
            <!-- ... (Your existing note buttons) ... -->
        </div>
    </div>

    <div id="teleopContainer" style="display: none; position: absolute; width: 100%;">
        <button id="n1" class="note-btn" style="position: absolute; top: 23%; left: 23%;"
        onclick="noteAction('Note 1')">Note
        1</button>
    <button id="n2" class="note-btn" style="position: absolute; top: 34%; left: 23%;"
        onclick="noteAction('Note 2')">Note
        2</button>
    <button id="n3" class="note-btn" style="position: absolute; top: 45%; left: 23%;"
        onclick="noteAction('Note 3')">Note
        3</button>
    <button id="n4" class="note-btn" style="position: absolute; top: 19.5%; left: 46.5%;"
        onclick="noteAction('Note 4')">Note
        4</button>
    <button id="n5" class="note-btn" style="position: absolute; top: 32.5%; left: 46.5%;"
        onclick="noteAction('Note 5')">Note
        5</button>
    <button id="n6" class="note-btn" style="position: absolute; top: 45.5%; left: 46.5%;"
        onclick="noteAction('Note 6')">Note
        6</button>
    <button id="n7" class="note-btn" style="position: absolute; top: 58.4%; left: 46.5%;"
        onclick="noteAction('Note 7')">Note
        7</button>
    <button id="n8" class="note-btn" style="position: absolute; top: 71%; left: 46.5%;"
        onclick="noteAction('Note 8')">Note
        8</button>
    <button id="n9" class="note-btn" style="position: absolute; top: 23%; left: 70.5%;"
        onclick="noteAction('Note 9')">Note
        9</button>
    <button id="n10" class="note-btn" style="position: absolute; top: 34%; left: 70.5%;"
        onclick="noteAction('Note 10')">Note
        10</button>
    <button id="n11" class="note-btn" style="position: absolute; top: 45%; left: 70.5%;"
        onclick="noteAction('Note 11')">Note
        11</button>
    </div>

    <!-- Note Outcome Section -->
    <div id="noteOutcome" style="display: none; padding-top:20px; position: fixed; top: 660px; right: 360px;">
        <button onclick="saveNoteOutcome('scored')">Scored</button>
        <button onclick="saveNoteOutcome('missed')">Missed</button>
        <button onclick="saveNoteOutcome('not picked up')">Not Picked Up</button>
        <button onclick="saveNoteOutcome('another team got it')">Another Team Got It</button>
    </div>

    <!-- Notes Section -->
    <div id="notesSection">
        <textarea id="notes" placeholder="Enter your notes here..."></textarea>
    </div>

    <script>
        // Drawing functionality
        const canvas = document.getElementById('field-canvas');
        const ctx = canvas.getContext('2d');
        let drawing = false;

        canvas.addEventListener('mousedown', function(e) {
            drawing = true;
            ctx.beginPath();
            ctx.moveTo(e.offsetX, e.offsetY);
        });

        canvas.addEventListener('mousemove', function(e) {
            if (drawing) {
                ctx.lineTo(e.offsetX, e.offsetY);
                ctx.stroke();
            }
        });

        canvas.addEventListener('mouseup', function(e) {
            drawing = false;
        });

        canvas.addEventListener('mouseout', function(e) {
            drawing = false;
        });

        // Drag-and-drop functionality
        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drag(ev) {
            ev.dataTransfer.setData("text/plain", ev.target.id);
        }

        function drop(ev) {
            ev.preventDefault();
            const data = ev.dataTransfer.getData("text/plain");
            const marker = document.getElementById(data);
            const rect = canvas.getBoundingClientRect();
            const x = ev.clientX - rect.left - (marker.width / 2);
            const y = ev.clientY - rect.top - (marker.height / 2);
            marker.style.left = x + 'px';
            marker.style.top = y + 'px';
            updateMarkerPosition(data, x, y);
        }

        // Attach drag-and-drop event listeners to the container
        const fieldContainer = document.getElementById('fieldContainer');
        fieldContainer.addEventListener('dragover', allowDrop);
        fieldContainer.addEventListener('drop', drop);

        function updateMarkerPosition(id, x, y) {
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData') || '{}');
            if (!scoutingData.defensePositions) {
                scoutingData.defensePositions = {};
            }
            scoutingData.defensePositions[id] = { x: x, y: y };
            sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));
        }

        // Existing JavaScript functions
        document.querySelectorAll('.position-btn').forEach(button => {
            button.addEventListener('click', function () {
                const position = this.innerText;
                selectPosition(position);
            });
        });

        document.querySelectorAll('.driver-station-btn').forEach(button => {
            button.addEventListener('click', function () {
                const driverStation = this.innerText;
                selectDriverStation(driverStation);
            });
        });

        function downloadSessionStorageData() {
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData') || '{}');
            const notes = document.getElementById('notes').value;

            scoutingData.notes = notes;

            if (!scoutingData) {
                alert('No scouting data available to download!');
                return;
            }

            const blob = new Blob([JSON.stringify(scoutingData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'scoutingData.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function selectDriverStation(driverStation) {
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData') || '{}');
            scoutingData.driverStation = driverStation;
            sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));
            checkSelections();
        }

        function selectPosition(position) {
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData') || '{}');
            scoutingData.robotPosition = position;
            sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));
            checkSelections();
        }

        function checkSelections() {
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData') || '{}');
            if (scoutingData.driverStation && scoutingData.robotPosition) {
                // Hide position and driver station buttons
                document.querySelectorAll('.position-btn, .driver-station-btn').forEach(button => {
                    button.style.display = 'none';
                });
                // Show notes container
                document.getElementById('notesContainer').style.display = 'block';
            }
        }

        function noteAction(note) {
            console.log('Note action for:', note);
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData'));
            if (!scoutingData.notes) {
                scoutingData.notes = [];
                scoutingData.autoActions = [];
            }
            scoutingData.notes.push(note);
            sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));

            // Show the note outcome options
            document.getElementById('noteOutcome').style.display = 'block';
            // Store the current note globally or in the session for outcome processing
            sessionStorage.setItem('currentNote', note);
        }

        function saveNoteOutcome(outcome) {
            const note = sessionStorage.getItem('currentNote');
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData'));
            // Append the outcome to the corresponding note
            if (!scoutingData.autoActions) {
                scoutingData.autoActions = [];
            }
            scoutingData.autoActions.push({ note: note, outcome: outcome });
            sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));

            // Hide the outcome buttons until the next note is selected
            document.getElementById('noteOutcome').style.display = 'none';
        }

        function startScouting() {
            const matchNumber = document.getElementById('matchNumber').value;
            const teamNumber = document.getElementById('teamNumber').value;
            if (matchNumber && teamNumber) {
                const scoutingData = {
                    matchNumber: matchNumber,
                    teamNumber: teamNumber,
                    actions: []
                };
                sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));
                alert('Scouting started!');
            } else {
                alert('Please enter both match and team numbers.');
            }
        }

        function startTeleop() {
            // Hide all note buttons and show Teleop actions
            document.getElementById('field').style.display = "none";
            document.getElementById('notesContainer').style.display = 'none';
            document.getElementById('noteOutcome').style.display = 'none'; // Hide outcomes if visible
            document.getElementById('teleopContainer').style.display = 'block';

            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData'));
            scoutingData.teleopActions = [];
            sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));
            logScreenWidth();
            logScreenHeight();
        }

        function logAction(action) {
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData'));

            // Check if the action is a pickup
            if (action === 'Ground Pickup' || action === 'Source BLUE' || action === 'Source RED' || action === 'Ground Pickup 1' || action === 'Ground Pickup 2' || action === 'Ground Pickup 3') {
                // Store the pickup action directly to teleopActions with a placeholder for shot/place
                scoutingData.teleopActions.push({ pickup: action, shot_place: null });

                // Temporarily store the index of this action to link with its corresponding shot/place
                scoutingData.currentActionIndex = scoutingData.teleopActions.length - 1;

                // Show additional options for what happens after the pickup
                showAdditionalActions();
            } else {
                // If it's a shot/place action, pair it with the last recorded pickup
                if (typeof scoutingData.currentActionIndex !== 'undefined') {
                    // Access the current action object and update it with the shot/place action
                    scoutingData.teleopActions[scoutingData.currentActionIndex].shot_place = action;

                    // Clear the temporary index after updating to prepare for the next series of actions
                    delete scoutingData.currentActionIndex;

                    // After logging a shot/place, revert to showing the initial pickup options
                    hideAdditionalActions();
                }
            }

            // Save the updated scouting data back to sessionStorage
            sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));
            console.log(action + ' action logged.');
        }

        function showAdditionalActions() {
            // Hide initial Teleop buttons and show additional actions
            document.getElementById('groundPickupButton1').style.display = 'none';
            document.getElementById('groundPickupButton2').style.display = 'none';
            document.getElementById('groundPickupButton3').style.display = 'none';

            document.getElementById('sourceButton').style.display = 'none';
            document.getElementById('sourceButton2').style.display = 'none';
            document.getElementById('additionalActions').style.display = 'block';
        }

        function hideAdditionalActions() {
            // Hide additional actions and show initial Teleop buttons again
            document.getElementById('additionalActions').style.display = 'none';
            document.getElementById('groundPickupButton1').style.display = 'inline';
            document.getElementById('groundPickupButton2').style.display = 'inline';
            document.getElementById('groundPickupButton3').style.display = 'inline';

            document.getElementById('sourceButton').style.display = 'inline';
            document.getElementById('sourceButton2').style.display = 'inline';
        }

        function startEndgame() {
            // Show endgame buttons
            document.getElementById('endgameContainer').style.display = 'block';
            document.getElementById('additionalActions').style.display = 'none';
            document.getElementById('groundPickupButton1').style.display = 'none';
            document.getElementById('groundPickupButton2').style.display = 'none';
            document.getElementById('groundPickupButton3').style.display = 'none';

            document.getElementById('sourceButton').style.display = 'none';
            document.getElementById('sourceButton2').style.display = 'none';

            // Hide the "Start Endgame" button to prevent multiple endgame starts
            document.querySelector('button[onclick="startEndgame()"]').style.display = 'none';
        }

        function logScreenWidth() {
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData')) || {};
            scoutingData.screenWidth = screen.width;
            sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));
        }

        function logScreenHeight() {
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData')) || {};
            scoutingData.screenHeight = screen.height;
            sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));
        }

        function logEndgameAction(action) {
            // Store the endgame action and show the secondary buttons
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData')) || {};
            scoutingData.endgameAction = action;
            sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));

            console.log(action + ' endgame action logged.');

            // Show the secondary endgame outcome buttons
            document.getElementById('endgameOutcome').style.display = 'block';
        }

        function saveEndgameOutcome(outcome) {
            // Retrieve the endgame action and append the outcome to it
            const scoutingData = JSON.parse(sessionStorage.getItem('scoutingData')) || {};
            const endgameAction = scoutingData.endgameAction || {};
            scoutingData.endgameActions = scoutingData.endgameActions || [];
            scoutingData.endgameActions.push({ action: endgameAction, outcome: outcome });

            sessionStorage.setItem('scoutingData', JSON.stringify(scoutingData));

            console.log(endgameAction + ' endgame action outcome logged as ' + outcome + '.');

            // Hide the endgameOutcome buttons and the endgame action buttons
            document.getElementById('endgameOutcome').style.display = 'none';
            document.getElementById('endgameContainer').style.display = 'none';
        }

        localStorage.setItem("isRotate", "true");
        var isRotate = localStorage.getItem("isRotate") === "true";

        function rotateField() {
            console.log(!isRotate);
            if (isRotate) {
                localStorage.setItem("isRotate", "false");
                document.getElementById('field-canvas').style.transform = "rotate(180deg)";
                // Adjust positions of buttons and markers if needed
            } else {
                localStorage.setItem("isRotate", "true");
                document.getElementById('field-canvas').style.transform = "rotate(0deg)";
                // Adjust positions of buttons and markers back to original
            }

            isRotate = localStorage.getItem("isRotate") === "true";
        }
    </script>
</body>
</html>
