<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre Match Checklist</title>
    <script src="jquery-3.3.1.slim.min.js"></script>
    <script src="bootstrap.min.js"></script>
    <link href="bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }

        nav {
            margin-bottom: 20px;
        }

        .navbar-light .navbar-nav .nav-link {
            color: #696868;
        }

        .navbar-light .navbar-nav .nav-link:hover {
            color: #000000;
        }

        #checklistContainer {
            padding: 20px;
            background: #ffffff;
            border-radius: 0.25rem;
            box-shadow: 0 0.45rem 0.25rem rgba(0,0,0,0.075);
        }

        .checklist-item {
            margin-bottom: 10px;
        }

        .checklist-item label {
            font-size: 1.125rem;
            font-weight: bold;
            margin-left: 10px;
        }

        .form-control {
            border-radius: 0.25rem;
        }

        .btn, .upload-btn {
            cursor: pointer;
        }

        .btn-primary, .upload-btn {
            color: #fff;
            background-color: #007bff;
            border-color: #007bff;
        }

        .btn-primary:hover, .upload-btn:hover {
            color: #fff;
            background-color: #0069d9;
            border-color: #0062cc;
        }

        .btn-success {
            color: #fff;
            background-color: #28a745;
            border-color: #28a745;
        }

        .btn-success:hover {
            color: #fff;
            background-color: #218838;
            border-color: #1e7e34;
        }

        input[type="file"] {
            display: none;
        }
       

/* Ensure uniform size and margin for buttons and labels */
.button-wrapper label {
    margin: 0; /* Override default margins if necessary */
    height: 38px; /* Adjust based on your design needs */
    display: inline-flex; /* Align text and icons within buttons/labels */
    align-items: center; /* Center items vertically inside the button/label */
    justify-content: center; /* Center items horizontally inside the button/label */
}
.upload-success-alert {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    visibility: hidden; /* Initially hidden */
    opacity: 0;
    z-index: 1051; /* Higher than Bootstrap modals */
    transition: visibility 0s linear 0.5s, opacity 0.5s linear; /* Delay visibility change */
    background-color: #d4edda; /* Light green background */
    color: #155724; /* Dark green text */
    border-color: #c3e6cb;
    padding: 0.75rem 1.25rem;
    border-radius: 0.25rem;
}

.upload-success-alert.show {
    visibility: visible;
    opacity: 1;
    transition: opacity 0.5s linear;
}
/* Dark Mode Toggle Switch Styles */
.switch {
  position: relative;
  display: inline-block;
  width: 80px;
  height: 34px;
  margin: 10px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  transition: background-color .4s;
  border-radius: 34px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  transition: transform .4s;
  border-radius: 50%;
}

input:checked + .slider {
  background-color: #555; /* Dark mode slider color */
}

input:checked + .slider:before {
  transform: translateX(46px); /* Slide to the right */
}

.icon {
  color: #fff;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-size: 20px;
  transition: opacity 0.4s; /* Smooth transition for opacity */
}

.sun {
  left: 10px;
  opacity: 0; /* Start hidden */
}

.moon {
  right: 10px;
  opacity: 1; /* Start visible */
}

input:checked + .slider .sun {
  opacity: 1; /* Fade in when dark mode is on */
}

input:checked + .slider .moon {
  opacity: 0; /* Fade out when dark mode is on */
}

input:not(:checked) + .slider .sun {
  opacity: 0; /* Remain hidden when light mode is on */
}

input:not(:checked) + .slider .moon {
  opacity: 1; /* Remain visible when light mode is on */
}

/* Styles for dark and light modes */
.bg-dark, .navbar-dark {
  background-color: #343a40 !important; /* Dark gray background */
  color: #f8f9fa !important; /* Light text for readability */
}

body.bg-dark div {
    background-color: #343a40 !important; /* Dark gray background */
  color: #f8f9fa !important; /* Light text for readability */
}

body.bg-dark a {
    background-color: #343a40 !important; /* Dark gray background */
  color: #f8f9fa !important; /* Light text for readability */
}
body.bg-dark .dropdown-item:hover {
    background-color: #f8f9fa !important; /* Light gray background */
  color: #343a40 !important; /* Dark text for readability */
}

.bg-light, .navbar-light {
  background-color: #f8f9fa !important; /* Light gray background */
  color: #343a40 !important; /* Dark text for readability */
}

/* Enhanced specific selectors for navbar in dark mode */
.navbar-dark {
  background-color: #343a40 !important; /* Dark gray background */
  color: #f8f9fa !important; /* Light text for readability */
}

.navbar-dark .navbar-nav .nav-link,
.navbar-dark .navbar-brand {
  color: #f8f9fa !important; /* Ensure navbar text colors are adjusted for dark mode */
}

.navbar-dark .navbar-toggler-icon {
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'%3e%3cpath stroke='rgba(248, 249, 250, 1)' stroke-width='2' stroke-linecap='round' stroke-miterlimit='10' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e") !important;
}

    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm mb-4">
        <div class="container">
            <a class="navbar-brand" href="./index.html">Robort</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="./index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./Team_List_element.html">Teams</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Scouting
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="./Strat_Board_w_tabs.html">Canvas</a>
                            <a class="dropdown-item" href="./scoutingGen.html">Scouting Generator</a>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./Checklist.html">Pre Match Checklist</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./2423_Features.html">Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Config_tab.html">Configure</a>
                    </li>
                </ul>
                <label class="switch">
                    <input type="checkbox" id="darkModeToggle">
                    <span class="slider round">
                      <span class="icon sun">ðŸŒž</span> <!-- Sun icon -->
                      <span class="icon moon">ðŸŒœ</span> <!-- Moon icon -->
                    </span>
                  </label>
            </div>
        </div>
    </nav>
   <!-- <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">Pre Match Checklist</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
            <a class="nav-item nav-link" href="./index.html">Home <span class="sr-only">(current)</span></a>
            <a class="nav-item nav-link" href="./Team_List_element.html">Teams</a>
            <a class="nav-item nav-link" href="./Strat_Board_w_tabs.html">Canvas</a>
            <a class="nav-item nav-link active" href="./Checklist.html">Pre Match Checklist</a>
            <a class="nav-item nav-link" href="./2423_Features.html">Features</a>
            <a class="nav-item nav-link" href="./Config_tab.html">Configure</a>
        </div>
    </div>
</nav> -->
    <div class="container mt-4" id="checklistContainer">
        <!-- Checklist items will be dynamically inserted here -->
    </div>
    
    <div class="container mt-4 justify-content-between button-wrapper">
        <form id="addItemForm" class="mb-3">
            <div class="input-group mb-3">
                <input type="text" id="newItems" class="form-control" placeholder="Enter items separated by commas" aria-label="Checklist item">
                <div class="input-group-append">
                    <button class="btn btn-outline-secondary" type="submit">Add Items</button>
                </div>
            </div>
        </form>
        <button id="clearChecklist" class="btn btn-danger" data-toggle="modal" data-target="#clearModal">Clear Checklist</button>
        <button id="downloadChecklist" class="btn btn-success">Download Checklist</button>
        <input type="file" id="uploadChecklist">
        <input type="file" id="uploadChecklistInput" style="display: none;">
<label for="uploadChecklistInput" class="btn btn-info upload-btn">Upload Checklist</label>

    </div>
    <!-- Add Bootstrap Modal for Clear Confirmation -->
    <div class="modal fade" id="clearModal" tabindex="-1" role="dialog" aria-labelledby="clearModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="clearModalLabel">Clear Checklist</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Are you sure you want to clear the checklist? This action will remove all items from local storage.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmClear">Clear Checklist</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Error Modal -->
<div class="modal fade" id="errorModal" tabindex="-1" role="dialog" aria-labelledby="errorModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="errorModalLabel">Upload Error</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="errorModalBody">
                The file is not valid JSON.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const checklistContainer = document.getElementById('checklistContainer');
            const addItemForm = document.getElementById('addItemForm');
            const newItemsInput = document.getElementById('newItems');
            let checklistItems = [];
            loadChecklist();

            function renderChecklist(items) {
                checklistContainer.innerHTML = '';
                items.forEach((item, index) => {
                    const div = document.createElement('div');
                    div.className = 'checklist-item form-check';
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.id = 'check-' + index;
                    checkbox.className = 'form-check-input';
                    const label = document.createElement('label');
                    label.htmlFor = 'check-' + index;
                    label.className = 'form-check-label';
                    label.textContent = typeof item === 'object' ? item.text : item;
                    div.appendChild(checkbox);
                    div.appendChild(label);
                    checklistContainer.appendChild(div);
                // Listener to update localStorage when an item is checked/unchecked
        checkbox.addEventListener('change', () => {
            checklistItems[index].checked = checkbox.checked; // Update the 'checked' state
            localStorage.setItem('preMatchChecklistItems', JSON.stringify(checklistItems)); // Save updated list
        });
    });
            }

            document.getElementById('confirmClear').addEventListener('click', function() {
    checklistItems = []; // Clear the array
    localStorage.removeItem('preMatchChecklistItems'); // Clear local storage
    renderChecklist(checklistItems); // Re-render the checklist (now empty)
    $('#clearModal').modal('hide'); // Hide the confirmation modal
});
function loadChecklist() {
    const storedItems = JSON.parse(localStorage.getItem('preMatchChecklistItems'));
    if (storedItems) {
        checklistItems = storedItems;
    } else {
        checklistItems = [];
    }
    renderChecklist(checklistItems);
}


addItemForm.addEventListener('submit', function(e) {
    e.preventDefault();
    const newItems = newItemsInput.value.split(',');
    checklistItems = checklistItems.concat(newItems.filter(item => item.trim() !== '')); // Filter out any empty strings
    localStorage.setItem('preMatchChecklistItems', JSON.stringify(checklistItems)); // Save updated list to localStorage
    renderChecklist(checklistItems);
    newItemsInput.value = '';
});


            const downloadChecklistButton = document.getElementById('downloadChecklist');
            const uploadChecklistInput = document.getElementById('uploadChecklist');

            downloadChecklistButton.addEventListener('click', function() {
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(checklistItems));
                const downloadAnchorNode = document.createElement('a');
                downloadAnchorNode.setAttribute("href", dataStr);
                downloadAnchorNode.setAttribute("download", "checklistItems.json");
                document.body.appendChild(downloadAnchorNode);
                downloadAnchorNode.click();
                downloadAnchorNode.remove();
            });

            document.getElementById('uploadChecklistInput').addEventListener('change', function(e) {
    const fileReader = new FileReader();
    fileReader.onload = function() {
        try {
            const contents = JSON.parse(fileReader.result);
            checklistItems = contents;
            renderChecklist(checklistItems);
            localStorage.setItem('preMatchChecklistItems', JSON.stringify(checklistItems));
            showSuccessAlert('Upload success!');
        } catch (error) {
            console.error("Error parsing uploaded file as JSON:", error);
            // Show error modal instead of alert
            showErrorModal("Upload failed: The file is not a valid JSON.");
        }
    };
    if (e.target.files[0]) {
        fileReader.readAsText(e.target.files[0]);
    }
});

// Function to display the error modal with a custom message
function showErrorModal(errorMessage) {
    document.getElementById('errorModalBody').textContent = errorMessage; // Set the error message
    $('#errorModal').modal('show'); // Use jQuery to show the modal
}



        });

        function showSuccessAlert(message) {
    const alertBox = document.createElement('div');
    alertBox.className = 'alert alert-success upload-success-alert';
    alertBox.innerHTML = `<span class="mr-2">&#10003;</span>${message}`;
    document.body.appendChild(alertBox);

    // Trigger reflow to ensure the transition can happen
    alertBox.offsetHeight; // Read offsetHeight to force reflow

    // Start fade in
    alertBox.classList.add('show');

    // Start fade out after a delay
    setTimeout(() => {
        alertBox.classList.remove('show');

        // Remove the element after the fade-out transition completes
        setTimeout(() => {
            document.body.removeChild(alertBox);
        }, 500); // Match the CSS transition duration
    }, 3000); // Visible duration before starting fade-out
}
    </script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
      const toggle = document.getElementById('darkModeToggle');
      const body = document.body;
      const navbar = document.querySelector('.navbar'); // Select the navbar element
    
      // Function to apply dark mode classes
      function enableDarkMode() {
        body.classList.add('bg-dark');
        body.classList.remove('bg-light');
        navbar.classList.add('navbar-dark');
        navbar.classList.remove('navbar-light', 'bg-white');
        document.querySelectorAll('.navbar').forEach(element => {
          element.classList.add('bg-dark');
          element.classList.remove('bg-white');
        });
      }
    
      // Function to remove dark mode classes
      function disableDarkMode() {
        body.classList.add('bg-light');
        body.classList.remove('bg-dark');
        navbar.classList.add('navbar-light');
        navbar.classList.remove('navbar-dark', 'bg-dark');
        document.querySelectorAll('.navbar').forEach(element => {
          element.classList.add('bg-white');
          element.classList.remove('bg-dark');
        });
      }
    
      // Initialize dark mode from local storage
      if (localStorage.getItem('darkMode') === 'true') {
        enableDarkMode();
        toggle.checked = true;
      } else {
        disableDarkMode();
      }
    
      // Toggle dark mode on change
      toggle.addEventListener('change', function() {
        if (this.checked) {
          localStorage.setItem('darkMode', 'true');
          enableDarkMode();
        } else {
          localStorage.setItem('darkMode', 'false');
          disableDarkMode();
        }
      });
    });
    </script>
</body>
</html>
