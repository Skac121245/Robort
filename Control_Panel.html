<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Interactive Workspace</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }

        #sidebar {
            width: 200px;
            height: 100%;
            position: fixed;
            left: 0;
            top: 0;
            background: #f0f0f0;
            padding: 10px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.2);
            transition: left 0.5s;
        }

        #sidebarToggle {
            right: 20px; /* Adjusted to not overlap edit mode button */
            position: fixed;
    top: 20px; /* Adjust so it's below the edit mode button */

  
        }

        .iframe-option {
            cursor: grab;
            padding: 10px;
            margin-bottom: 5px;
            background: #ddd;
            user-select: none;
        }

        .iframe-option:hover {
            background: #ccc;
        }

        #workspace {
            margin-left: 200px;
            height: 100%;
            position: relative;
            transition: margin-left 0.5s;
        }

        .iframe-container {
            position: absolute;
            border: 2px solid #ccc;
            resize: both;
            overflow: auto;
        }

        #editModeToggle {
            position: fixed;
            top: 20px;
            right: 220px;
            z-index: 1000;
        }

        .edit-mode iframe {
            pointer-events: none;
            user-select: none; 
        }
    </style>
</head>
<body>

<div id="sidebar">
    <div class="iframe-option" draggable="true" data-src="Matches_element.html">Matches_element</div>
    <div class="iframe-option" draggable="true" data-src="preMatchChecklist.html">Pre Match Check</div>
    <!-- Add more iframe options here -->
</div>
<div id="workspace"></div>
<button id="editModeToggle">Toggle Move Mode</button>
<button id="sidebarToggle">Toggle Sidebar</button> <!-- Toggle button for sidebar -->
<div id="iframeList" style="position:fixed; top:60px; right:20px; width:180px;"></div>
<script>
    let editMode = false;
    let dropped = false;
    let dropped1 = false;
    document.getElementById('editModeToggle').addEventListener('click', () => {
        editMode = !editMode;
        console.log("blah");
        document.body.classList.toggle('edit-mode', editMode);
    });

    document.querySelectorAll('.iframe-option').forEach(option => {
        option.addEventListener('dragstart', function(e) {
            const src = option.getAttribute('data-src');
            e.dataTransfer.setData('text/plain', src);
        });
    });

    const workspace = document.getElementById('workspace');

    workspace.addEventListener('dragover', function(e) {
        e.preventDefault();
    });

    const toggleText = document.querySelector("#editModeToggle"); // Correct variable name
toggleText.addEventListener("click", function() {
    if (editMode) {
        console.log("blurg")
        this.textContent = "Move Mode Toggled On"; // Correct way to set text content
    } else
    {
        this.textContent = "Move Mode Toggled Off"
    }
    if (!dropped && !dropped1) {
        this.textContent = "Move Mode Toggled On";
        dropped1 = true; 
    } else if (!editMode)
    {
        this.textContent = "Move Mode Toggled Off";
    }
});
    
    workspace.addEventListener('drop', function(e) {
        e.preventDefault();
        dropped = true;
        const src = e.dataTransfer.getData('text/plain');
        const iframeContainer = document.createElement('div');
        iframeContainer.classList.add('iframe-container');
        iframeContainer.style.left = (e.clientX - 250) + 'px'; // Adjusting to workspace offset
        iframeContainer.style.top = e.clientY + 'px';
        iframeContainer.innerHTML = `<iframe src="${src}" frameborder="0" style="width:100%; height:100%;"></iframe>`;
        // Create list item for iframe
const listItem = document.createElement('div');
listItem.style.padding = '10px';
listItem.style.marginBottom = '5px';
listItem.style.background = '#ddd';
listItem.style.cursor = 'pointer';
listItem.textContent = src.split('/').pop().split('.')[0]; // Display filename without extension as name

// Add delete icon
const deleteIcon = document.createElement('span');
deleteIcon.textContent = 'x';
deleteIcon.style.float = 'right';
deleteIcon.style.cursor = 'pointer';
listItem.appendChild(deleteIcon);

// Append the list item to the iframe list
document.getElementById('iframeList').appendChild(listItem);

// Delete functionality
deleteIcon.addEventListener('click', function(event) {
    event.stopPropagation(); // Prevent triggering listItem click event
    const confirmDelete = confirm('Are you sure you want to delete this iframe?');
    if (confirmDelete) {
        iframeContainer.remove(); // Remove iframe from workspace
        listItem.remove(); // Remove list item
    }
});

        console.log("HI:", iframeContainer, editMode)
        // if (editMode || true) {
        // Enable moving and resizing
        iframeContainer.style.resize = 'both';
        iframeContainer.style.overflow = 'auto';
        // iframeContainer.children.forEach(child => {
        //     child.styles.
        // })

        let isDragging = false;


        iframeContainer.addEventListener('mousedown', e => {
            console.log("MOUSE DOWN")
            if (!editMode) return;
            isDragging = true;
            let startX = e.pageX - iframeContainer.offsetLeft;
            let startY = e.pageY - iframeContainer.offsetTop;

            function onMove(e) {
                if (!isDragging) return;
                iframeContainer.style.left = (e.pageX - startX) + 'px';
                iframeContainer.style.top = (e.pageY - startY) + 'px';
            }

            function onUp() {
                isDragging = false;
                window.removeEventListener('mousemove', onMove);
                window.removeEventListener('mouseup', onUp);
            }

            window.addEventListener('mousemove', onMove);
            window.addEventListener('mouseup', onUp);
        });
        // }

        workspace.appendChild(iframeContainer);
    });
    let sidebarVisible = true; // New variable to track the visibility of the sidebar

// Sidebar toggle functionality
document.getElementById('sidebarToggle').addEventListener('click', () => {
    sidebarVisible = !sidebarVisible;
    const sidebar = document.getElementById('sidebar');
    const workspace = document.getElementById('workspace');
    if (sidebarVisible) {
        sidebar.style.left = '0';
        workspace.style.marginLeft = '200px';
    } else {
        sidebar.style.left = '-200px';
        workspace.style.marginLeft = '0';
    }
});

</script>
</body>
</html>
