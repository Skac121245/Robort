<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Interactive Workspace</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <style>
        body, html {
            height: 100%;
            overflow: hidden;
        }

        #sidebar {
            background: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease-in-out;
            z-index: 1060; /* Ensure sidebar is above other content but below fixed-top nav */
        }

        .iframe-option {
            cursor: pointer;
            padding: 0.5rem 1rem;
            margin-bottom: 0.5rem;
            background: #e9ecef;
            border: 1px solid #dee2e6;
            border-radius: 0.25rem;
        }

        .iframe-option:hover {
            background: #dde4e9;
        }

        nav {
            background-color: #f8f9fa;
            margin-bottom: 1rem;
            padding: 0.5rem 0;
            border-radius: 0.25rem;
            box-shadow: 0 2px 4px rgba(0,0,0,.1);
        }

        nav a {
            color: #007bff;
            margin: 0 15px;
        }

        nav a:hover {
            color: #0056b3;
        }

        #workspace {
            transition: margin-left 0.3s;
        }

        .iframe-container {
            border: 1px solid #dee2e6;
            resize: both;
            overflow: auto;
        }

        #editModeToggle, #sidebarToggle, #hideNavButton {
            margin: 0.5rem;
        }

        .highlight {
            animation: outlineFadeInOut 3s;
        }

        @keyframes outlineFadeInOut {
            0%, 100% { outline: none; }
            50% { outline: 2px solid #ffc107; }
        }

        #workspace {
    transition: margin-left 0.3s ease;
}
.buttons-container {
    z-index: 1050; /* Higher than most elements */
}

#sidebarToggle {
    transition: left 0.5s ease-in-out, top 0.5s ease-in-out;
}

    </style>
</head>
<body>
    <button id="sidebarToggle" class="btn btn-secondary position-fixed" style="top: 50px; left: calc(200px + 10px);">Toggle Sidebar</button>
    <!-- Bootstrap's JavaScript -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <div id="mobileOverlay" onclick="goBack()" class="d-md-none position-fixed w-100 h-100" style="background-color: rgba(0,0,0,0.5); cursor: pointer; display: none;">
        <div id="mobileMessage" class="position-absolute text-white" style="top: 50%; left: 50%; transform: translate(-50%, -50%);">
            This site can only run on a desktop.<br>
            <button class="btn btn-primary mt-3" onclick="window.history.back();">Go Back</button>
        </div>
    </div>

    <nav id="nav" class="container">
        <a href="./index.html">Home</a>
        <a href="./Team_List_element.html">Teams</a>
        <a href="./Strat_Board_w_tabs.html">Canvas</a>
        <a href="./Checklist.html">Pre Match Checklist</a>
        <a href="./2423_Features.html">Features</a>
    </nav>
    <div id="workspace" style="position: absolute; top: 60px; left: 210px; right: 0; bottom: 0; overflow: auto;"></div>

    <div id="sidebar" class="bg-light border-right" style="width: 200px; position: fixed; top: 0; bottom: 0; overflow-y: auto;">
        <div class="list-group list-group-flush">
            <div class="iframe-option list-group-item list-group-item-action d-flex justify-content-between align-items-center" draggable="true" data-src="Matches_element.html">Matches</div>
            <div class="iframe-option list-group-item list-group-item-action d-flex justify-content-between align-items-center" draggable="true" data-src="Checklist.html">Pre-Match Checklist</div>
            <div class="iframe-option list-group-item list-group-item-action d-flex justify-content-between align-items-center" draggable="true" data-src="DriverStationPopulate.html">Canvas</div>
            <div class="iframe-option list-group-item list-group-item-action d-flex justify-content-between align-items-center" draggable="true" data-src="crescendo-cheat-sheet.png">Crescendo Cheat Sheet</div>
        </div>
        <div class="mt-auto p-2">
            <button id="editModeToggle" class="btn btn-info mb-2 w-80">Toggle Move Mode</button>
            <button id="hideNavButton" class="btn btn-light mb-2 w-80">Hide Nav</button>
        </div>
    </div>

    
    <div id="iframeList" class="position-fixed" style="top: 60px; right: 20px; width: 180px;"></div>
    <script>
        // Toggles for sidebar and edit mode
        let editMode = false;
        document.getElementById('editModeToggle').addEventListener('click', function() {
    editMode = !editMode;
    document.body.classList.toggle('edit-mode', editMode);
    this.textContent = editMode ? "Move Mode On" : "Move Mode Off";

    // Assuming your iframe containers have the class 'iframe-container'
    const iframeContainers = document.querySelectorAll('.iframe-container');

    // Check if jQuery UI is loaded and iframeContainers exist
    if (window.jQuery && jQuery.ui && iframeContainers.length) {
        // Toggle draggable based on the editMode
        if (editMode) {
            $(iframeContainers).draggable({ disabled: false });
        } else {
            $(iframeContainers).draggable({ disabled: true });
        }
    }
});

    
        document.getElementById('sidebarToggle').addEventListener('click', function() {
    const sidebar = document.getElementById('sidebar');
    const button = this; // 'this' refers to the #sidebarToggle button itself
    const isHidden = sidebar.style.transform === 'translateX(-200px)';

    // Toggle sidebar visibility
    sidebar.style.transform = isHidden ? 'translateX(0px)' : 'translateX(-200px)';

    // Move button to the top left when the sidebar is hidden, and back to original position when shown
    if (isHidden) {
        // Adjust button position when the sidebar is shown
        button.style.left = 'calc(200px + 10px)';
        button.style.top = '50px';
    } else {
        // Move button to the top left when the sidebar is hidden
        button.style.left = '10px';
        button.style.top = '10px';
    }
});


    
        document.getElementById('hideNavButton').addEventListener('click', function() {
            const nav = document.getElementById('nav');
            nav.style.display = nav.style.display === 'none' ? 'block' : 'none';
        });
    
        // Drag-and-drop functionality
        document.querySelectorAll('.iframe-option').forEach(option => {
            option.addEventListener('dragstart', function(e) {
                const src = option.getAttribute('data-src');
                e.dataTransfer.setData('text/plain', src);
            });
        });
    
        const workspace = document.getElementById('workspace');
        workspace.addEventListener('dragover', function(e) {
            e.preventDefault();
        });
    
        workspace.addEventListener('drop', function(e) {
    e.preventDefault();
    const src = e.dataTransfer.getData('text/plain');

    // Assuming you're using the presence of 'src' to determine if this is a new iframe
    // Modify this logic based on how you're currently determining whether to create a new iframe
    if (src && !e.target.getAttribute('data-in-workspace')) {
        createIframeContainer(src, e.clientX - parseInt(workspace.style.left), e.clientY - parseInt(workspace.style.top));
    }
});
    
        function createIframeContainer(src, x, y) {
    // Create the container div
    const iframeContainer = document.createElement('div');
    iframeContainer.classList.add('iframe-container');
    iframeContainer.style.position = 'absolute';
    iframeContainer.style.left = x + 'px';
    iframeContainer.style.top = y + 'px';
    iframeContainer.style.width = '400px'; // Set a default width
    iframeContainer.style.height = '300px'; // Set a default height

    // Check if src is an image or webpage to decide between img and iframe tag
    if (src.endsWith('.png') || src.endsWith('.jpg') || src.endsWith('.gif')) {
        // For images, create an img element
        const img = document.createElement('img');
        img.src = src;
        img.style.width = '100%';
        img.style.height = '100%';
        iframeContainer.appendChild(img);
    } else {
        // For web pages, create an iframe element
        const iframe = document.createElement('iframe');
        iframe.src = src;
        iframe.style.width = '100%';
        iframe.style.height = '100%';
        iframe.frameBorder = '0'; // Remove border for cleaner look
        iframeContainer.appendChild(iframe);
    }

    // Append the container to the workspace
    const workspace = document.getElementById('workspace');
    workspace.appendChild(iframeContainer);

    // Make the container resizable and draggable
    $(iframeContainer).resizable().draggable();
}
        
    </script>
    
</body>
</html>
